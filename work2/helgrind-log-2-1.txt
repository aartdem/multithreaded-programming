==18093== Helgrind, a thread error detector
==18093== Copyright (C) 2007-2017, and GNU GPL'd, by OpenWorks LLP et al.
==18093== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==18093== Command: ./main
==18093== Parent PID: 11488
==18093== 
==18093== ---Thread-Announcement------------------------------------------
==18093== 
==18093== Thread #1 is the program's root thread
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==18093==    at 0x48513D6: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10BCD1: std::future<std::result_of<main::{lambda()#1} ()>::type> ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&) (ThreadPool.h:82)
==18093==    by 0x10B9B1: main (example.cpp:15)
==18093== 
==18093== ---Thread-Announcement------------------------------------------
==18093== 
==18093== Thread #5 was created
==18093==    at 0x4BE89F3: clone (clone.S:76)
==18093==    by 0x4BE98EE: __clone_internal (clone-internal.c:83)
==18093==    by 0x4B576D8: create_thread (pthread_create.c:295)
==18093==    by 0x4B581FF: pthread_create@@GLIBC_2.34 (pthread_create.c:828)
==18093==    by 0x4853767: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4953328: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x1144E3: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:143)
==18093==    by 0x113812: void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (new_allocator.h:162)
==18093==    by 0x11205F: void std::allocator_traits<std::allocator<std::thread> >::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::allocator<std::thread>&, std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (alloc_traits.h:516)
==18093==    by 0x11098F: std::thread& std::vector<std::thread, std::allocator<std::thread> >::emplace_back<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (vector.tcc:115)
==18093==    by 0x10F981: ThreadPool::ThreadPool(unsigned long) (ThreadPool.h:38)
==18093==    by 0x10B96A: main (example.cpp:10)
==18093== 
==18093== ---Thread-Announcement------------------------------------------
==18093== 
==18093== Thread #2 was created
==18093==    at 0x4BE89F3: clone (clone.S:76)
==18093==    by 0x4BE98EE: __clone_internal (clone-internal.c:83)
==18093==    by 0x4B576D8: create_thread (pthread_create.c:295)
==18093==    by 0x4B581FF: pthread_create@@GLIBC_2.34 (pthread_create.c:828)
==18093==    by 0x4853767: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4953328: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x1144E3: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:143)
==18093==    by 0x113812: void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (new_allocator.h:162)
==18093==    by 0x11205F: void std::allocator_traits<std::allocator<std::thread> >::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::allocator<std::thread>&, std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (alloc_traits.h:516)
==18093==    by 0x112135: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (vector.tcc:449)
==18093==    by 0x1109D5: std::thread& std::vector<std::thread, std::allocator<std::thread> >::emplace_back<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (vector.tcc:121)
==18093==    by 0x10F981: ThreadPool::ThreadPool(unsigned long) (ThreadPool.h:38)
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x122098 by thread #5
==18093== Locks held: none
==18093==    at 0x49B3A22: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 1 at 0x4DEB3C5 by thread #5
==18093== Locks held: none
==18093==    at 0x4859796: mempcpy (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4B4E664: _IO_new_file_xsputn (fileops.c:1235)
==18093==    by 0x4B4E664: _IO_file_xsputn@@GLIBC_2.2.5 (fileops.c:1196)
==18093==    by 0x4B42FD6: fwrite (iofwrite.c:39)
==18093==    by 0x49B3B64: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x4deb3c5 is 5 bytes inside a block of size 1,024 alloc'd
==18093==    at 0x484A919: malloc (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4B41BA3: _IO_file_doallocate (filedoalloc.c:101)
==18093==    by 0x4B50CDF: _IO_doallocbuf (genops.c:347)
==18093==    by 0x4B4FF5F: _IO_file_overflow@@GLIBC_2.2.5 (fileops.c:744)
==18093==    by 0x4B4E6D4: _IO_new_file_xsputn (fileops.c:1243)
==18093==    by 0x4B4E6D4: _IO_file_xsputn@@GLIBC_2.2.5 (fileops.c:1196)
==18093==    by 0x4B42FD6: fwrite (iofwrite.c:39)
==18093==    by 0x49B3B64: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==  Block was alloc'd by thread #2
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x122098 by thread #5
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122169 by thread #5
==18093== Locks held: none
==18093==    at 0x49B40E6: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41C8: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122169 is 233 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122168 by thread #5
==18093== Locks held: none
==18093==    at 0x49B40F3: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41BF: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122168 is 232 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 1 at 0x4DEB3C6 by thread #5
==18093== Locks held: none
==18093==    at 0x48597B4: mempcpy (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4B4E664: _IO_new_file_xsputn (fileops.c:1235)
==18093==    by 0x4B4E664: _IO_file_xsputn@@GLIBC_2.2.5 (fileops.c:1196)
==18093==    by 0x4B42FD6: fwrite (iofwrite.c:39)
==18093==    by 0x49A5AF7: std::ostreambuf_iterator<char, std::char_traits<char> > std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_int<long>(std::ostreambuf_iterator<char, std::char_traits<char> >, std::ios_base&, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B4119: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x4deb3c6 is 6 bytes inside a block of size 1,024 alloc'd
==18093==    at 0x484A919: malloc (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4B41BA3: _IO_file_doallocate (filedoalloc.c:101)
==18093==    by 0x4B50CDF: _IO_doallocbuf (genops.c:347)
==18093==    by 0x4B4FF5F: _IO_file_overflow@@GLIBC_2.2.5 (fileops.c:744)
==18093==    by 0x4B4E6D4: _IO_new_file_xsputn (fileops.c:1243)
==18093==    by 0x4B4E6D4: _IO_file_xsputn@@GLIBC_2.2.5 (fileops.c:1196)
==18093==    by 0x4B42FD6: fwrite (iofwrite.c:39)
==18093==    by 0x49B3B64: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==  Block was alloc'd by thread #2
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA17F8 by thread #5
==18093== Locks held: none
==18093==    at 0x49B37FE: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B8AE: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x494DFBC: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa17f8 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA1803 by thread #5
==18093== Locks held: none
==18093==    at 0x49B3807: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B8AE: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 2 by thread #2
==18093== Locks held: none
==18093==    at 0x494DEE1: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa1803 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ---Thread-Announcement------------------------------------------
==18093== 
==18093== Thread #3 was created
==18093==    at 0x4BE89F3: clone (clone.S:76)
==18093==    by 0x4BE98EE: __clone_internal (clone-internal.c:83)
==18093==    by 0x4B576D8: create_thread (pthread_create.c:295)
==18093==    by 0x4B581FF: pthread_create@@GLIBC_2.34 (pthread_create.c:828)
==18093==    by 0x4853767: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x4953328: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x1144E3: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:143)
==18093==    by 0x113812: void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (new_allocator.h:162)
==18093==    by 0x11205F: void std::allocator_traits<std::allocator<std::thread> >::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::allocator<std::thread>&, std::thread*, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (alloc_traits.h:516)
==18093==    by 0x112135: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (vector.tcc:449)
==18093==    by 0x1109D5: std::thread& std::vector<std::thread, std::allocator<std::thread> >::emplace_back<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (vector.tcc:121)
==18093==    by 0x10F981: ThreadPool::ThreadPool(unsigned long) (ThreadPool.h:38)
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x122098 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3A22: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B8ED: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #3
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x122098 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B8ED: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #3
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x4DEA6D8 by thread #1
==18093== Locks held: none
==18093==    at 0x112C48: std::__uniq_ptr_impl<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::_M_ptr() const (unique_ptr.h:173)
==18093==    by 0x111385: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::get() const (unique_ptr.h:422)
==18093==    by 0x10FE20: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::operator*() const (unique_ptr.h:408)
==18093==    by 0x10F044: std::__future_base::_State_baseV2::wait() (future:337)
==18093==    by 0x1129C5: std::__basic_future<int>::_M_get_result() const (future:719)
==18093==    by 0x1110E6: std::future<int>::get() (future:805)
==18093==    by 0x10BA4A: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x112E44: std::enable_if<std::__and_<std::__not_<std::__is_tuple_like<std::__future_base::_Result_base*> >, std::is_move_constructible<std::__future_base::_Result_base*>, std::is_move_assignable<std::__future_base::_Result_base*> >::value, void>::type std::swap<std::__future_base::_Result_base*>(std::__future_base::_Result_base*&, std::__future_base::_Result_base*&) (move.h:205)
==18093==    by 0x11181E: std::__uniq_ptr_impl<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::swap(std::__uniq_ptr_impl<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>&) (unique_ptr.h:196)
==18093==    by 0x1102B4: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::swap(std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>&) (unique_ptr.h:464)
==18093==    by 0x10F551: std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) (future:576)
==18093==    by 0x112CE8: void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:74)
==18093==    by 0x11143A: std::__invoke_result<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>::type std::__invoke<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:96)
==18093==    by 0x10FEB5: std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::{lambda()#1}::operator()() const (mutex:776)
==18093==    by 0x11146A: std::once_flag::_Prepare_execution::_Prepare_execution<std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::{lambda()#1}>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::{lambda()#1}::operator()() const (mutex:712)
==18093==  Address 0x4dea6d8 is 24 bytes inside a block of size 64 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10D229: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:127)
==18093==    by 0x10D0B0: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:464)
==18093==    by 0x10CE9D: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:98)
==18093==    by 0x10CCEF: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:648)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==    by 0x10C9B3: std::packaged_task<int ()>::packaged_task<std::_Bind<main::{lambda()#1} ()>, void>(std::_Bind<main::{lambda()#1} ()>&&) (future:1535)
==18093==    by 0x10C8B2: void __gnu_cxx::new_allocator<std::packaged_task<int ()> >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (new_allocator.h:162)
==18093==    by 0x10C7AD: void std::allocator_traits<std::allocator<std::packaged_task<int ()> > >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::allocator<std::packaged_task<int ()> >&, std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (alloc_traits.h:516)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 4 at 0x4DEA750 by thread #1
==18093== Locks held: none
==18093==    at 0x1110F7: std::future<int>::get() (future:805)
==18093==    by 0x10BA4A: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 4 by thread #2
==18093== Locks held: none
==18093==    at 0x1171C0: std::__future_base::_Result<int>::_M_set(int&&) (future:257)
==18093==    by 0x10E35B: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093==    by 0x10DBA5: std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int> >::_M_invoke(std::_Any_data const&) (std_function.h:291)
==18093==    by 0x110307: std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const (std_function.h:590)
==18093==    by 0x10F533: std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) (future:571)
==18093==    by 0x112CE8: void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:74)
==18093==  Address 0x4dea750 is 16 bytes inside a block of size 24 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x116894: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__future_base::_S_allocate_result<int, int>(std::allocator<int> const&) (future:302)
==18093==    by 0x1167D2: std::__future_base::_Task_state_base<int ()>::_Task_state_base<std::allocator<int> >(std::allocator<int> const&) (future:1434)
==18093==    by 0x10D349: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_Task_state<std::_Bind<main::{lambda()#1} ()> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1460)
==18093==    by 0x10D2CA: void __gnu_cxx::new_allocator<int>::construct<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (new_allocator.h:162)
==18093==    by 0x10D195: void std::allocator_traits<std::allocator<int> >::construct<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (alloc_traits.h:516)
==18093==    by 0x10CFE8: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int>, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:519)
==18093==    by 0x10CD62: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:650)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x4DEA6D0 by thread #1
==18093== Locks held: none
==18093==    at 0x10D3E3: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::~_Task_state() (future:1454)
==18093==    by 0x10DAE3: void __gnu_cxx::new_allocator<int>::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (new_allocator.h:168)
==18093==    by 0x10D8D0: void std::allocator_traits<std::allocator<int> >::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (alloc_traits.h:535)
==18093==    by 0x10D534: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() (shared_ptr_base.h:528)
==18093==    by 0x111206: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() (shared_ptr_base.h:168)
==18093==    by 0x10FCC4: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count() (shared_ptr_base.h:705)
==18093==    by 0x10F5B7: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr() (shared_ptr_base.h:1154)
==18093==    by 0x1118D5: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::reset() (shared_ptr_base.h:1272)
==18093==    by 0x112982: std::__basic_future<int>::_Reset::~_Reset() (future:755)
==18093==    by 0x111104: std::future<int>::get() (future:806)
==18093==    by 0x10BA4A: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous read of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x11265C: std::packaged_task<int ()>::operator()() (future:1604)
==18093==    by 0x10BB57: ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}::operator()() const (ThreadPool.h:80)
==18093==    by 0x10C7F9: void std::__invoke_impl<void, ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}&>(std::__invoke_other, ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10C6B3: std::enable_if<is_invocable_r_v<void, ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}&>, void>::type std::__invoke_r<void, ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}&>(ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}&) (invoke.h:111)
==18093==    by 0x10C48D: std::_Function_handler<void (), ThreadPool::enqueue<main::{lambda()#1}>(main::{lambda()#1}&&)::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==18093==    by 0x11093B: std::function<void ()>::operator()() const (std_function.h:590)
==18093==    by 0x10F813: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (ThreadPool.h:55)
==18093==    by 0x1170CD: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==18093==  Address 0x4dea6d0 is 16 bytes inside a block of size 64 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10D229: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:127)
==18093==    by 0x10D0B0: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:464)
==18093==    by 0x10CE9D: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:98)
==18093==    by 0x10CCEF: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:648)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==    by 0x10C9B3: std::packaged_task<int ()>::packaged_task<std::_Bind<main::{lambda()#1} ()>, void>(std::_Bind<main::{lambda()#1} ()>&&) (future:1535)
==18093==    by 0x10C8B2: void __gnu_cxx::new_allocator<std::packaged_task<int ()> >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (new_allocator.h:162)
==18093==    by 0x10C7AD: void std::allocator_traits<std::allocator<std::packaged_task<int ()> > >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::allocator<std::packaged_task<int ()> >&, std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (alloc_traits.h:516)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x4DEA6F0 by thread #1
==18093== Locks held: none
==18093==    at 0x116833: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::~unique_ptr() (unique_ptr.h:360)
==18093==    by 0x11673D: std::__future_base::_Task_state_base<int ()>::~_Task_state_base() (future:1427)
==18093==    by 0x10D401: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::~_Task_state() (future:1454)
==18093==    by 0x10DAE3: void __gnu_cxx::new_allocator<int>::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (new_allocator.h:168)
==18093==    by 0x10D8D0: void std::allocator_traits<std::allocator<int> >::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (alloc_traits.h:535)
==18093==    by 0x10D534: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() (shared_ptr_base.h:528)
==18093==    by 0x111206: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() (shared_ptr_base.h:168)
==18093==    by 0x10FCC4: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count() (shared_ptr_base.h:705)
==18093==    by 0x10F5B7: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr() (shared_ptr_base.h:1154)
==18093==    by 0x1118D5: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::reset() (shared_ptr_base.h:1272)
==18093==    by 0x112982: std::__basic_future<int>::_Reset::~_Reset() (future:755)
==18093==    by 0x111104: std::future<int>::get() (future:806)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x117270: std::__uniq_ptr_impl<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::__uniq_ptr_impl(std::__uniq_ptr_impl<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>&&) (unique_ptr.h:163)
==18093==    by 0x1170F8: std::__uniq_ptr_data<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter, true, true>::__uniq_ptr_data(std::__uniq_ptr_data<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter, true, true>&&) (unique_ptr.h:211)
==18093==    by 0x117122: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::unique_ptr(std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>&&) (unique_ptr.h:327)
==18093==    by 0x10E37C: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1396)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093==    by 0x10DBA5: std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int> >::_M_invoke(std::_Any_data const&) (std_function.h:291)
==18093==    by 0x110307: std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const (std_function.h:590)
==18093==  Address 0x4dea6f0 is 48 bytes inside a block of size 64 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10D229: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:127)
==18093==    by 0x10D0B0: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:464)
==18093==    by 0x10CE9D: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:98)
==18093==    by 0x10CCEF: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:648)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==    by 0x10C9B3: std::packaged_task<int ()>::packaged_task<std::_Bind<main::{lambda()#1} ()>, void>(std::_Bind<main::{lambda()#1} ()>&&) (future:1535)
==18093==    by 0x10C8B2: void __gnu_cxx::new_allocator<std::packaged_task<int ()> >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (new_allocator.h:162)
==18093==    by 0x10C7AD: void std::allocator_traits<std::allocator<std::packaged_task<int ()> > >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::allocator<std::packaged_task<int ()> >&, std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (alloc_traits.h:516)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x4DEA6F0 by thread #1
==18093== Locks held: none
==18093==    at 0x116868: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::~unique_ptr() (unique_ptr.h:362)
==18093==    by 0x11673D: std::__future_base::_Task_state_base<int ()>::~_Task_state_base() (future:1427)
==18093==    by 0x10D401: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::~_Task_state() (future:1454)
==18093==    by 0x10DAE3: void __gnu_cxx::new_allocator<int>::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (new_allocator.h:168)
==18093==    by 0x10D8D0: void std::allocator_traits<std::allocator<int> >::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (alloc_traits.h:535)
==18093==    by 0x10D534: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() (shared_ptr_base.h:528)
==18093==    by 0x111206: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() (shared_ptr_base.h:168)
==18093==    by 0x10FCC4: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count() (shared_ptr_base.h:705)
==18093==    by 0x10F5B7: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr() (shared_ptr_base.h:1154)
==18093==    by 0x1118D5: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::reset() (shared_ptr_base.h:1272)
==18093==    by 0x112982: std::__basic_future<int>::_Reset::~_Reset() (future:755)
==18093==    by 0x111104: std::future<int>::get() (future:806)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x117270: std::__uniq_ptr_impl<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::__uniq_ptr_impl(std::__uniq_ptr_impl<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>&&) (unique_ptr.h:163)
==18093==    by 0x1170F8: std::__uniq_ptr_data<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter, true, true>::__uniq_ptr_data(std::__uniq_ptr_data<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter, true, true>&&) (unique_ptr.h:211)
==18093==    by 0x117122: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>::unique_ptr(std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>&&) (unique_ptr.h:327)
==18093==    by 0x10E37C: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1396)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093==    by 0x10DBA5: std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int> >::_M_invoke(std::_Any_data const&) (std_function.h:291)
==18093==    by 0x110307: std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const (std_function.h:590)
==18093==  Address 0x4dea6f0 is 48 bytes inside a block of size 64 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10D229: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:127)
==18093==    by 0x10D0B0: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:464)
==18093==    by 0x10CE9D: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:98)
==18093==    by 0x10CCEF: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:648)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==    by 0x10C9B3: std::packaged_task<int ()>::packaged_task<std::_Bind<main::{lambda()#1} ()>, void>(std::_Bind<main::{lambda()#1} ()>&&) (future:1535)
==18093==    by 0x10C8B2: void __gnu_cxx::new_allocator<std::packaged_task<int ()> >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (new_allocator.h:162)
==18093==    by 0x10C7AD: void std::allocator_traits<std::allocator<std::packaged_task<int ()> > >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::allocator<std::packaged_task<int ()> >&, std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (alloc_traits.h:516)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4DEA754 by thread #1
==18093== Locks held: none
==18093==    at 0x116D84: std::__future_base::_Result<int>::~_Result() (future:239)
==18093==    by 0x116DC3: std::__future_base::_Result<int>::~_Result() (future:241)
==18093==    by 0x116D5D: std::__future_base::_Result<int>::_M_destroy() (future:262)
==18093==    by 0x10EF00: std::__future_base::_Result_base::_Deleter::operator()(std::__future_base::_Result_base*) const (future:212)
==18093==    by 0x10FDC3: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::~unique_ptr() (unique_ptr.h:361)
==18093==    by 0x1166DB: std::__future_base::_State_baseV2::~_State_baseV2() (future:327)
==18093==    by 0x116749: std::__future_base::_Task_state_base<int ()>::~_Task_state_base() (future:1427)
==18093==    by 0x10D401: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::~_Task_state() (future:1454)
==18093==    by 0x10DAE3: void __gnu_cxx::new_allocator<int>::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (new_allocator.h:168)
==18093==    by 0x10D8D0: void std::allocator_traits<std::allocator<int> >::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (alloc_traits.h:535)
==18093==    by 0x10D534: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() (shared_ptr_base.h:528)
==18093==    by 0x111206: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() (shared_ptr_base.h:168)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x1171C6: std::__future_base::_Result<int>::_M_set(int&&) (future:258)
==18093==    by 0x10E35B: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093==    by 0x10DBA5: std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int> >::_M_invoke(std::_Any_data const&) (std_function.h:291)
==18093==    by 0x110307: std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const (std_function.h:590)
==18093==    by 0x10F533: std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) (future:571)
==18093==    by 0x112CE8: void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:74)
==18093==  Address 0x4dea754 is 20 bytes inside a block of size 24 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x116894: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__future_base::_S_allocate_result<int, int>(std::allocator<int> const&) (future:302)
==18093==    by 0x1167D2: std::__future_base::_Task_state_base<int ()>::_Task_state_base<std::allocator<int> >(std::allocator<int> const&) (future:1434)
==18093==    by 0x10D349: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_Task_state<std::_Bind<main::{lambda()#1} ()> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1460)
==18093==    by 0x10D2CA: void __gnu_cxx::new_allocator<int>::construct<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (new_allocator.h:162)
==18093==    by 0x10D195: void std::allocator_traits<std::allocator<int> >::construct<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (alloc_traits.h:516)
==18093==    by 0x10CFE8: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int>, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:519)
==18093==    by 0x10CD62: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:650)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x4DEA6D8 by thread #1
==18093== Locks held: none
==18093==    at 0x10FDC8: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::~unique_ptr() (unique_ptr.h:362)
==18093==    by 0x1166DB: std::__future_base::_State_baseV2::~_State_baseV2() (future:327)
==18093==    by 0x116749: std::__future_base::_Task_state_base<int ()>::~_Task_state_base() (future:1427)
==18093==    by 0x10D401: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::~_Task_state() (future:1454)
==18093==    by 0x10DAE3: void __gnu_cxx::new_allocator<int>::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (new_allocator.h:168)
==18093==    by 0x10D8D0: void std::allocator_traits<std::allocator<int> >::destroy<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >(std::allocator<int>&, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*) (alloc_traits.h:535)
==18093==    by 0x10D534: std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() (shared_ptr_base.h:528)
==18093==    by 0x111206: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() (shared_ptr_base.h:168)
==18093==    by 0x10FCC4: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count() (shared_ptr_base.h:705)
==18093==    by 0x10F5B7: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr() (shared_ptr_base.h:1154)
==18093==    by 0x1118D5: std::__shared_ptr<std::__future_base::_State_baseV2, (__gnu_cxx::_Lock_policy)2>::reset() (shared_ptr_base.h:1272)
==18093==    by 0x112982: std::__basic_future<int>::_Reset::~_Reset() (future:755)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x112E44: std::enable_if<std::__and_<std::__not_<std::__is_tuple_like<std::__future_base::_Result_base*> >, std::is_move_constructible<std::__future_base::_Result_base*>, std::is_move_assignable<std::__future_base::_Result_base*> >::value, void>::type std::swap<std::__future_base::_Result_base*>(std::__future_base::_Result_base*&, std::__future_base::_Result_base*&) (move.h:205)
==18093==    by 0x11181E: std::__uniq_ptr_impl<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::swap(std::__uniq_ptr_impl<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>&) (unique_ptr.h:196)
==18093==    by 0x1102B4: std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>::swap(std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>&) (unique_ptr.h:464)
==18093==    by 0x10F551: std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) (future:576)
==18093==    by 0x112CE8: void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:74)
==18093==    by 0x11143A: std::__invoke_result<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>::type std::__invoke<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) (invoke.h:96)
==18093==    by 0x10FEB5: std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::{lambda()#1}::operator()() const (mutex:776)
==18093==    by 0x11146A: std::once_flag::_Prepare_execution::_Prepare_execution<std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::{lambda()#1}>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::{lambda()#1}::operator()() const (mutex:712)
==18093==  Address 0x4dea6d8 is 24 bytes inside a block of size 64 alloc'd
==18093==    at 0x484B093: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10D229: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:127)
==18093==    by 0x10D0B0: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:464)
==18093==    by 0x10CE9D: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:98)
==18093==    by 0x10CCEF: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>*&, std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:648)
==18093==    by 0x10CC69: std::__shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr_base.h:1342)
==18093==    by 0x10CB96: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> >::shared_ptr<std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::_Sp_alloc_shared_tag<std::allocator<int> >, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:409)
==18093==    by 0x10CB09: std::shared_ptr<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()> > std::allocate_shared<std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>, std::allocator<int>, std::_Bind<main::{lambda()#1} ()>, std::allocator<int> const&>(std::allocator<int> const&, std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (shared_ptr.h:863)
==18093==    by 0x10CA86: std::shared_ptr<std::__future_base::_Task_state_base<int ()> > std::__create_task_state<int (), std::_Bind<main::{lambda()#1} ()>, std::allocator<int> >(std::_Bind<main::{lambda()#1} ()>&&, std::allocator<int> const&) (future:1504)
==18093==    by 0x10C9B3: std::packaged_task<int ()>::packaged_task<std::_Bind<main::{lambda()#1} ()>, void>(std::_Bind<main::{lambda()#1} ()>&&) (future:1535)
==18093==    by 0x10C8B2: void __gnu_cxx::new_allocator<std::packaged_task<int ()> >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (new_allocator.h:162)
==18093==    by 0x10C7AD: void std::allocator_traits<std::allocator<std::packaged_task<int ()> > >::construct<std::packaged_task<int ()>, std::_Bind<main::{lambda()#1} ()> >(std::allocator<std::packaged_task<int ()> >&, std::packaged_task<int ()>*, std::_Bind<main::{lambda()#1} ()>&&) (alloc_traits.h:516)
==18093==  Block was alloc'd by thread #1
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122169 by thread #1
==18093== Locks held: none
==18093==    at 0x49B40E6: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BA5B: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41C8: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122169 is 233 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122168 by thread #1
==18093== Locks held: none
==18093==    at 0x49B40F3: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BA5B: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41BF: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122168 is 232 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x122098 by thread #1
==18093== Locks held: none
==18093==    at 0x49A5ACF: std::ostreambuf_iterator<char, std::char_traits<char> > std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_int<long>(std::ostreambuf_iterator<char, std::char_traits<char> >, std::ios_base&, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B4119: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BA5B: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during write of size 8 at 0x122098 by thread #1
==18093== Locks held: none
==18093==    at 0x49A5ADB: std::ostreambuf_iterator<char, std::char_traits<char> > std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_int<long>(std::ostreambuf_iterator<char, std::char_traits<char> >, std::ios_base&, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B4119: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BA5B: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #2
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122169 by thread #5
==18093== Locks held: none
==18093==    at 0x49B40E6: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B900: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41C8: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122169 is 233 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x122168 by thread #5
==18093== Locks held: none
==18093==    at 0x49B40F3: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B900: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x49B41BF: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==  Address 0x122168 is 232 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA17F8 by thread #5
==18093== Locks held: none
==18093==    at 0x49B37FE: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B912: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x494DFBC: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa17f8 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA1803 by thread #5
==18093== Locks held: none
==18093==    at 0x49B3807: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B912: main::{lambda()#1}::operator()() const (example.cpp:18)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==    by 0x10D8F3: std::enable_if<is_invocable_r_v<int, std::_Bind<main::{lambda()#1} ()>&>, int>::type std::__invoke_r<int, std::_Bind<main::{lambda()#1} ()>&>(std::_Bind<main::{lambda()#1} ()>&) (invoke.h:114)
==18093==    by 0x10D652: std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}::operator()() const (future:1468)
==18093==    by 0x10E349: std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>::operator()() const (future:1386)
==18093==    by 0x10E1A4: std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:61)
==18093==    by 0x10DE68: std::enable_if<is_invocable_r_v<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::{lambda()#1} ()>, std::allocator<int>, int ()>::_M_run()::{lambda()#1}, int>&) (invoke.h:116)
==18093== 
==18093== This conflicts with a previous write of size 2 by thread #2
==18093== Locks held: none
==18093==    at 0x494DEE1: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa1803 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 8 at 0x122098 by thread #1
==18093== Locks held: none
==18093==    at 0x49B3E58: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BA68: main (example.cpp:25)
==18093== 
==18093== This conflicts with a previous write of size 8 by thread #5
==18093== Locks held: none
==18093==    at 0x49B3AE0: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B3EBA: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B889: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x122098 is 24 bytes inside data symbol "_ZSt4cout@GLIBCXX_3.4"
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA17F8 by thread #1
==18093== Locks held: none
==18093==    at 0x49B37FE: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BAAD: main (example.cpp:26)
==18093== 
==18093== This conflicts with a previous write of size 1 by thread #2
==18093== Locks held: none
==18093==    at 0x494DFBC: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa17f8 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Possible data race during read of size 1 at 0x4AA1803 by thread #1
==18093== Locks held: none
==18093==    at 0x49B3807: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10BAAD: main (example.cpp:26)
==18093== 
==18093== This conflicts with a previous write of size 2 by thread #2
==18093== Locks held: none
==18093==    at 0x494DEE1: std::ctype<char>::_M_widen_init() const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x49B41E7: std::ostream& std::ostream::_M_insert<long>(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==18093==    by 0x10B89C: main::{lambda()#1}::operator()() const (example.cpp:16)
==18093==    by 0x10E655: int std::__invoke_impl<int, main::{lambda()#1}&>(std::__invoke_other, main::{lambda()#1}&) (invoke.h:61)
==18093==    by 0x10E304: std::__invoke_result<main::{lambda()#1}&>::type std::__invoke<main::{lambda()#1}&>(main::{lambda()#1}&) (invoke.h:96)
==18093==    by 0x10E12F: int std::_Bind<main::{lambda()#1} ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) (functional:420)
==18093==    by 0x10DD9A: int std::_Bind<main::{lambda()#1} ()>::operator()<, int>() (functional:503)
==18093==    by 0x10DB14: int std::__invoke_impl<int, std::_Bind<main::{lambda()#1} ()>&>(std::__invoke_other, std::_Bind<main::{lambda()#1} ()>&) (invoke.h:61)
==18093==  Address 0x4aa1803 is in the BSS segment of /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30
==18093== 
==18093== ----------------------------------------------------------------
==18093== 
==18093== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==18093==    at 0x48515C6: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==18093==    by 0x10FA54: ThreadPool::~ThreadPool() (ThreadPool.h:93)
==18093==    by 0x10BAD0: main (example.cpp:29)
==18093== 
==18093== 
==18093== Use --history-level=approx or =none to gain increased speed, at
==18093== the cost of reduced accuracy of conflicting-access information
==18093== For lists of detected and suppressed errors, rerun with: -s
==18093== ERROR SUMMARY: 265 errors from 30 contexts (suppressed: 574 from 71)
