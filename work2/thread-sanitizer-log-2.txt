==================
WARNING: ThreadSanitizer: data race (pid=20266)
  Write of size 4 at 0x7ffda453ff34 by thread T1:
    #0 main::$_0::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/example.cpp:16:28 (main+0xd42e1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #1 int std::__invoke_impl<int, main::$_0&>(std::__invoke_other, main::$_0&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd427d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #2 std::__invoke_result<main::$_0&>::type std::__invoke<main::$_0&>(main::$_0&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xd421d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #3 int std::_Bind<main::$_0 ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/functional:420:11 (main+0xd41c1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #4 int std::_Bind<main::$_0 ()>::operator()<int>() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/functional:503:17 (main+0xd4166) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #5 int std::__invoke_impl<int, std::_Bind<main::$_0 ()>&>(std::__invoke_other, std::_Bind<main::$_0 ()>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd40ed) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #6 std::enable_if<__and_<std::__not_<std::is_void<int> >, std::is_convertible<std::__invoke_result<std::_Bind<main::$_0 ()>&>::type, int> >::value, int>::type std::__invoke_r<int, std::_Bind<main::$_0 ()>&>(std::_Bind<main::$_0 ()>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:142:14 (main+0xd408d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #7 std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1468:13 (main+0xd4029) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #8 std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1386:27 (main+0xd3e96) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #9 std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd3df1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #10 std::enable_if<__and_<std::__not_<std::is_void<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> > >, std::is_convertible<std::__invoke_result<std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>::type, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> > >::value, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:142:14 (main+0xd3d01) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #11 std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int> >::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:290:9 (main+0xd3b2b) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #12 std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:590:9 (main+0xdeceb) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #13 std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:571:27 (main+0xde6c9) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #14 void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:74:14 (main+0xdec4d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #15 std::__invoke_result<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>::type std::__invoke<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xdea94) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #16 void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:776:4 (main+0xde9e3) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #17 std::once_flag::_Prepare_execution::_Prepare_execution<void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:712:21 (main+0xde915) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #18 std::once_flag::_Prepare_execution::_Prepare_execution<void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::'lambda'()::__invoke() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:712:16 (main+0xde8a5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #19 pthread_once <null> (main+0x53a4a) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #20 __gthread_once(int*, void (*)()) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/x86_64-linux-gnu/c++/11/bits/gthr-default.h:700:12 (main+0xd39f3) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #21 void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:783:21 (main+0xde608) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #22 std::__future_base::_State_baseV2::_M_set_result(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>, bool) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:411:2 (main+0xde3b0) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #23 std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1471:8 (main+0xd362d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #24 std::packaged_task<int ()>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1604:12 (main+0xe27f0) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #25 std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:80:33 (main+0xd5d9d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #26 main::$_0 std::__invoke_impl<void, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&>(std::__invoke_other, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd5d3d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #27 std::enable_if<__and_<std::is_void<main::$_0>, std::__is_invocable<std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&> >::value, main::$_0>::type std::__invoke_r<void, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&>(std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:154:7 (main+0xd5c9d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #28 std::_Function_handler<void (), std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:290:9 (main+0xd5a17) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #29 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:590:9 (main+0xd8fa7) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #30 ThreadPool::ThreadPool(unsigned long)::'lambda'()::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:55:25 (main+0xd8b8d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #31 void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd8a0d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #32 std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::'lambda'()>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xd895d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #33 void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:259:13 (main+0xd8905) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #34 std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> >::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:266:11 (main+0xd88a5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #35 std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:211:13 (main+0xd8739) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #36 <null> <null> (libstdc++.so.6+0xdc252) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)

  Previous write of size 4 at 0x7ffda453ff34 by thread T2:
    #0 main::$_0::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/example.cpp:16:28 (main+0xd42e1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #1 int std::__invoke_impl<int, main::$_0&>(std::__invoke_other, main::$_0&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd427d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #2 std::__invoke_result<main::$_0&>::type std::__invoke<main::$_0&>(main::$_0&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xd421d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #3 int std::_Bind<main::$_0 ()>::__call<int>(std::tuple<>&&, std::_Index_tuple<>) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/functional:420:11 (main+0xd41c1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #4 int std::_Bind<main::$_0 ()>::operator()<int>() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/functional:503:17 (main+0xd4166) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #5 int std::__invoke_impl<int, std::_Bind<main::$_0 ()>&>(std::__invoke_other, std::_Bind<main::$_0 ()>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd40ed) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #6 std::enable_if<__and_<std::__not_<std::is_void<int> >, std::is_convertible<std::__invoke_result<std::_Bind<main::$_0 ()>&>::type, int> >::value, int>::type std::__invoke_r<int, std::_Bind<main::$_0 ()>&>(std::_Bind<main::$_0 ()>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:142:14 (main+0xd408d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #7 std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1468:13 (main+0xd4029) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #8 std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1386:27 (main+0xd3e96) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #9 std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter> std::__invoke_impl<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>(std::__invoke_other, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd3df1) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #10 std::enable_if<__and_<std::__not_<std::is_void<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> > >, std::is_convertible<std::__invoke_result<std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>::type, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> > >::value, std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> >::type std::__invoke_r<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&>(std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:142:14 (main+0xd3d01) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #11 std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<int>, std::__future_base::_Result_base::_Deleter>, std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run()::'lambda'(), int> >::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:290:9 (main+0xd3b2b) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #12 std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:590:9 (main+0xdeceb) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #13 std::__future_base::_State_baseV2::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:571:27 (main+0xde6c9) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #14 void std::__invoke_impl<void, void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::__invoke_memfun_deref, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:74:14 (main+0xdec4d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #15 std::__invoke_result<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>::type std::__invoke<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xdea94) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #16 void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:776:4 (main+0xde9e3) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #17 std::once_flag::_Prepare_execution::_Prepare_execution<void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::'lambda'()::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:712:21 (main+0xde915) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #18 std::once_flag::_Prepare_execution::_Prepare_execution<void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&)::'lambda'()>(void (std::__future_base::_State_baseV2::*&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*))::'lambda'()::__invoke() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:712:16 (main+0xde8a5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #19 pthread_once <null> (main+0x53a4a) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #20 __gthread_once(int*, void (*)()) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/x86_64-linux-gnu/c++/11/bits/gthr-default.h:700:12 (main+0xd39f3) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #21 void std::call_once<void (std::__future_base::_State_baseV2::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*>(std::once_flag&, void (std::__future_base::_State_baseV2::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*, bool*), std::__future_base::_State_baseV2*&&, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>*&&, bool*&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/mutex:783:21 (main+0xde608) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #22 std::__future_base::_State_baseV2::_M_set_result(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>, bool) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:411:2 (main+0xde3b0) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #23 std::__future_base::_Task_state<std::_Bind<main::$_0 ()>, std::allocator<int>, int ()>::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1471:8 (main+0xd362d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #24 std::packaged_task<int ()>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/future:1604:12 (main+0xe27f0) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #25 std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:80:33 (main+0xd5d9d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #26 main::$_0 std::__invoke_impl<void, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&>(std::__invoke_other, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd5d3d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #27 std::enable_if<__and_<std::is_void<main::$_0>, std::__is_invocable<std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&> >::value, main::$_0>::type std::__invoke_r<void, std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&>(std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:154:7 (main+0xd5c9d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #28 std::_Function_handler<void (), std::future<std::result_of<main::$_0 ()>::type> ThreadPool::enqueue<main::$_0>(main::$_0&&)::'lambda'()>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:290:9 (main+0xd5a17) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #29 std::function<void ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_function.h:590:9 (main+0xd8fa7) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #30 ThreadPool::ThreadPool(unsigned long)::'lambda'()::operator()() const /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:55:25 (main+0xd8b8d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #31 void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:61:14 (main+0xd8a0d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #32 std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::'lambda'()>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/invoke.h:96:14 (main+0xd895d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #33 void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:259:13 (main+0xd8905) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #34 std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> >::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:266:11 (main+0xd88a5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #35 std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::'lambda'()> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/std_thread.h:211:13 (main+0xd8739) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #36 <null> <null> (libstdc++.so.6+0xdc252) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)

  Location is stack of main thread.

  Location is global '??' at 0x7ffda4522000 ([stack]+0x1df34)

  Thread T1 (tid=20268, running) created by main thread at:
    #0 pthread_create <null> (main+0x5071d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #1 std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) <null> (libstdc++.so.6+0xdc328) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)
    #2 void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::thread*, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/ext/new_allocator.h:162:23 (main+0xd8291) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #3 void std::allocator_traits<std::allocator<std::thread> >::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::allocator<std::thread>&, std::thread*, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/alloc_traits.h:516:8 (main+0xd7dfd) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #4 void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/vector.tcc:449:4 (main+0xd7f35) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #5 void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/vector.tcc:121:4 (main+0xd6a0a) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #6 ThreadPool::ThreadPool(unsigned long) /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:38:17 (main+0xd61b5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #7 main /home/aartdem/multithreaded-programming/work2/ThreadPool/example.cpp:8:16 (main+0xd16cb) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)

  Thread T2 (tid=20269, running) created by main thread at:
    #0 pthread_create <null> (main+0x5071d) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #1 std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) <null> (libstdc++.so.6+0xdc328) (BuildId: e37fe1a879783838de78cbc8c80621fa685d58a2)
    #2 void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::thread*, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/ext/new_allocator.h:162:23 (main+0xd8291) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #3 void std::allocator_traits<std::allocator<std::thread> >::construct<std::thread, ThreadPool::ThreadPool(unsigned long)::'lambda'()>(std::allocator<std::thread>&, std::thread*, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/alloc_traits.h:516:8 (main+0xd7dfd) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #4 void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/vector.tcc:449:4 (main+0xd7f35) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #5 void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<ThreadPool::ThreadPool(unsigned long)::'lambda'()>(ThreadPool::ThreadPool(unsigned long)::'lambda'()&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/vector.tcc:121:4 (main+0xd6a0a) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #6 ThreadPool::ThreadPool(unsigned long) /home/aartdem/multithreaded-programming/work2/ThreadPool/ThreadPool.h:38:17 (main+0xd61b5) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)
    #7 main /home/aartdem/multithreaded-programming/work2/ThreadPool/example.cpp:8:16 (main+0xd16cb) (BuildId: 0e6898bca92bee4a4c9667830531cfad52369769)

SUMMARY: ThreadSanitizer: data race /home/aartdem/multithreaded-programming/work2/ThreadPool/example.cpp:16:28 in main::$_0::operator()() const
